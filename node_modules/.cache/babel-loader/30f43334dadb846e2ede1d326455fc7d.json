{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\medium clone\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\medium clone\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\medium clone\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from\"react\";import TextareaAutosize from\"@material-ui/core/TextareaAutosize\";import Button from'@material-ui/core/Button';import\"./NewPost.css\";import{app}from\"../firebase\";import{AuthContext}from\"../Auth\";import Alert from'react-bootstrap/Alert';var db=app.firestore();var NewPost=function NewPost(){var _useContext=useContext(AuthContext),authuser=_useContext.authuser,userName=_useContext.userName,userEmail=_useContext.userEmail;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),fileUrl=_useState2[0],setFileUrl=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),content=_useState6[0],setContent=_useState6[1];var onFileChange=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var file,storageRef,fileRef;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:file=e.target.files[0];storageRef=app.storage().ref();fileRef=storageRef.child(file.name);_context.next=5;return fileRef.put(file);case 5:_context.t0=setFileUrl;_context.next=8;return fileRef.getDownloadURL();case 8:_context.t1=_context.sent;(0,_context.t0)(_context.t1);case 10:case\"end\":return _context.stop();}}},_callee);}));return function onFileChange(_x){return _ref.apply(this,arguments);};}();var savePost=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return{title:title,content:content,likesCount:0,imageUrl:fileUrl,name:userName,emailId:userEmail};case 2:data=_context2.sent;_context2.next=5;return db.collection(\"posts\").add(data);case 5:_context2.next=7;return setFileUrl(\"\");case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function savePost(_x2){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",null,authuser!=''?/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"input\",{type:\"file\",onChange:onFileChange}),/*#__PURE__*/React.createElement(\"form\",{action:\"/\"},/*#__PURE__*/React.createElement(\"img\",{src:fileUrl,alt:\"\"}),/*#__PURE__*/React.createElement(\"form\",{action:\"\"},/*#__PURE__*/React.createElement(TextareaAutosize,{value:title,onChange:function onChange(e){setTitle(e.target.value);},className:\"title\",placeholder:\"Title\"}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(TextareaAutosize,{value:content,onChange:function onChange(e){setContent(e.target.value);},className:\"content\",placeholder:\"Tell your story...\"})),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),authuser!=' '?/*#__PURE__*/React.createElement(Button,{type:\"submit\",variant:\"contained\",onClick:savePost},\"Post\"):/*#__PURE__*/React.createElement(Alert,{variant:\"danger\"},\" Please Sign In!!! \"))):window.location.href=\"/signIn\");};export default NewPost;","map":{"version":3,"sources":["D:/medium clone/src/components/NewPost.jsx"],"names":["React","useState","useContext","TextareaAutosize","Button","app","AuthContext","Alert","db","firestore","NewPost","authuser","userName","userEmail","fileUrl","setFileUrl","title","setTitle","content","setContent","onFileChange","e","file","target","files","storageRef","storage","ref","fileRef","child","name","put","getDownloadURL","savePost","likesCount","imageUrl","emailId","data","collection","add","value","window","location","href"],"mappings":"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","sourcesContent":["import React, { useState,useContext } from \"react\";\r\nimport TextareaAutosize from \"@material-ui/core/TextareaAutosize\";\r\nimport Button from '@material-ui/core/Button';\r\nimport \"./NewPost.css\";\r\nimport { app } from \"../firebase\";\r\nimport {AuthContext} from \"../Auth\";\r\nimport Alert from 'react-bootstrap/Alert'\r\n\r\nconst db = app.firestore();\r\n\r\nconst NewPost = () => {\r\n  const {authuser,userName,userEmail}=useContext(AuthContext)\r\n  const [fileUrl, setFileUrl] = useState(\"\");\r\n  const [title,setTitle]=useState(\"\")\r\n  const [content,setContent]=useState(\"\")\r\n\r\n  \r\n  const onFileChange = async (e) => {\r\n    const file = e.target.files[0];\r\n    const storageRef = app.storage().ref();\r\n    const fileRef = storageRef.child(file.name);\r\n    await fileRef.put(file);\r\n    setFileUrl(await fileRef.getDownloadURL());\r\n  };\r\n\r\n  const savePost =  async(e) =>{\r\n    let  data = await {\r\n      title:title,\r\n      content:content,\r\n      likesCount:0,\r\n      imageUrl:fileUrl,\r\n      name:userName,\r\n      emailId:userEmail\r\n    }\r\n    await db.collection(\"posts\").add(data)\r\n    await setFileUrl(\"\")\r\n  }\r\n  return ( \r\n    <div>\r\n\r\n      {\r\n        authuser != '' ? (\r\n    <div className=\"container\">\r\n      <input type=\"file\" onChange={onFileChange} />\r\n      <form   action=\"/\" >   \r\n      <img src={fileUrl} alt=\"\"/>\r\n      <form action=\"\">\r\n        <TextareaAutosize value={title} onChange={(e)=>{setTitle(e.target.value)}} className=\"title\" placeholder=\"Title\" />\r\n        <br />\r\n        <br />\r\n        <TextareaAutosize\r\n          value={content}\r\n          onChange={(e)=>{setContent(e.target.value)}}\r\n          className=\"content\"\r\n          placeholder=\"Tell your story...\"\r\n        />\r\n      </form>\r\n      <br/>\r\n      <br/>\r\n      {\r\n        authuser != ' ' ? (<Button type='submit' variant=\"contained\" onClick={savePost} >Post</Button>\r\n        ) :\r\n        ( <Alert variant =\"danger\"> Please Sign In!!! </Alert> )\r\n      }\r\n      \r\n      </form>\r\n    </div>\r\n        )\r\n        : (\r\n          window.location.href = \"/signIn\"\r\n        )\r\n\r\n      }\r\n</div>\r\n\r\n  );\r\n};\r\n\r\n\r\nexport default NewPost;\r\n"]},"metadata":{},"sourceType":"module"}